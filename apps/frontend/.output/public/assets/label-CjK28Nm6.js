import{r,N as d,f as K,E as P,b as x,i as $,c as k,d as q,e as z,j as R,g as F}from"./main-CH1Vho1T.js";import{m as G,n as H,o as Q}from"./api-DSxyYvsI.js";let L=(function(e){return e.disabled="data-disabled",e.valid="data-valid",e.invalid="data-invalid",e.touched="data-touched",e.dirty="data-dirty",e.filled="data-filled",e.focused="data-focused",e})({});const W={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:null,valueMissing:!1},X={valid(e){return e===null?null:e?{[L.valid]:""}:{[L.invalid]:""}}},Z=r.createContext({invalid:void 0,name:void 0,validityData:{state:W,errors:[],error:"",value:"",initialValue:null},setValidityData:d,disabled:void 0,touched:!1,setTouched:d,dirty:!1,setDirty:d,filled:!1,setFilled:d,focused:!1,setFocused:d,validate:()=>null,validationMode:"onSubmit",validationDebounceTime:0,shouldValidateOnChange:()=>!1,state:{disabled:!1,valid:null,touched:!1,dirty:!1,filled:!1,focused:!1},markedDirtyRef:{current:!1},validation:{getValidationProps:(e=P)=>e,getInputValidationProps:(e=P)=>e,inputRef:{current:null},commit:async()=>{}}});function h(e=!0){const t=r.useContext(Z);if(t.setValidityData===d&&!e)throw new Error(K(28));return t}const A=r.createContext({formRef:{current:{fields:new Map}},errors:{},clearErrors:d,validationMode:"onSubmit",submitAttemptedRef:{current:!1}});function ee(){return r.useContext(A)}const te=r.createContext({controlId:void 0,setControlId:d,labelId:void 0,setLabelId:d,messageIds:[],setMessageIds:d,getDescriptionProps:e=>e});function S(){return r.useContext(te)}function ae(e,t){return{...e,state:{...e.state,valid:!t&&e.state.valid}}}function ne({controlled:e,default:t,name:n,state:o="value"}){const{current:u}=r.useRef(e!==void 0),[i,f]=r.useState(t),a=u?e:i,v=r.useCallback(b=>{u||f(b)},[]);return[a,v]}function le(e={}){const{id:t,implicit:n=!1,controlRef:o}=e,{controlId:u,setControlId:i}=S(),f=G(t);return x(()=>{if(!(!n&&!t||i===d)){if(n){const a=o?.current;$(a)&&a.closest("label")!=null?i(t??null):i(u??f)}else t&&i(t);return()=>{t&&i(void 0)}}},[t,o,u,i,n,f]),u??f}function ie(e){const{enabled:t=!0,value:n,id:o,name:u,controlRef:i,commit:f}=e,{formRef:a}=ee(),{invalid:v,markedDirtyRef:b,validityData:p,setValidityData:y}=h(),m=k(e.getValue);x(()=>{if(!t)return;let s=n;s===void 0&&(s=m()),p.initialValue===null&&s!==null&&y(I=>({...I,initialValue:s}))},[t,y,n,p.initialValue,m]),x(()=>{!t||!o||a.current.fields.set(o,{getValue:m,name:u,controlRef:i,validityData:ae(p,v),validate(){let s=n;s===void 0&&(s=m()),b.current=!0,q.flushSync(()=>f(s))}})},[f,i,t,a,m,o,v,b,u,p,n]),x(()=>{const s=a.current.fields;return()=>{o&&s.delete(o)}},[a,o])}const se=r.forwardRef(function(t,n){const{render:o,className:u,id:i,name:f,value:a,disabled:v=!1,onValueChange:b,defaultValue:p,...y}=t,{state:m,name:s,disabled:I}=h(),C=I||v,E=s??f,N=r.useMemo(()=>({...m,disabled:C}),[m,C]),{setTouched:M,setDirty:U,validityData:j,setFocused:T,setFilled:V,validationMode:O,validation:c}=h(),{labelId:B}=S(),w=le({id:i});x(()=>{const l=a!=null;c.inputRef.current?.value||l&&a!==""?V(!0):l&&a===""&&V(!1)},[c.inputRef,V,a]);const[D,_]=ne({controlled:a,default:p,name:"FieldControl",state:"value"}),Y=a!==void 0,J=k((l,g)=>{b?.(l,g),!g.isCanceled&&_(l)});return ie({id:w,name:E,commit:c.commit,value:D,getValue:()=>c.inputRef.current?.value,controlRef:c.inputRef}),z("input",t,{ref:n,state:N,props:[{id:w,disabled:C,name:E,ref:c.inputRef,"aria-labelledby":B,...Y?{value:D}:{defaultValue:p},onChange(l){const g=l.currentTarget.value;J(g,H(Q,l.nativeEvent)),U(g!==j.initialValue),V(g!=="")},onFocus(){T(!0)},onBlur(l){M(!0),T(!1),O==="onBlur"&&c.commit(l.currentTarget.value)},onKeyDown(l){l.currentTarget.tagName==="INPUT"&&l.key==="Enter"&&(M(!0),c.commit(l.currentTarget.value))}},c.getInputValidationProps(),y],stateAttributesMapping:X})}),re=r.forwardRef(function(t,n){return R.jsx(se,{ref:n,...t})});function fe({className:e,type:t,...n}){return R.jsx(re,{type:t,"data-slot":"input",className:F("dark:bg-input/30 border-input focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 disabled:bg-input/50 dark:disabled:bg-input/80 h-8 rounded-none border bg-transparent px-2.5 py-1 text-xs transition-colors file:h-6 file:text-xs file:font-medium focus-visible:ring-1 aria-invalid:ring-1 md:text-xs file:text-foreground placeholder:text-muted-foreground w-full min-w-0 outline-none file:inline-flex file:border-0 file:bg-transparent disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",e),...n})}function ce({className:e,...t}){return R.jsx("label",{"data-slot":"label",className:F("gap-2 text-xs leading-none group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",e),...t})}export{fe as I,ce as L};
