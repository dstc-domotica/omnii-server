import{u as E,r as t,j as e,B as m}from"./main-CH1Vho1T.js";import{g as R,C as a,a as n,b as x,c as h,B as T,u as H}from"./api-DSxyYvsI.js";import{L as u,I as S}from"./label-CjK28Nm6.js";function B(){const{theme:y,toggleTheme:C}=E(),[P,g]=t.useState(!0),[p,j]=t.useState(!1),[f,c]=t.useState(null),[b,l]=t.useState(!1),[i,v]=t.useState(""),[d,N]=t.useState("50051"),[r,w]=t.useState(void 0);t.useEffect(()=>{o()},[]);async function o(){try{g(!0),c(null);const s=await R();s.serverHost&&v(s.serverHost),s.grpcPort&&N(String(s.grpcPort)),s.grpcServer&&w(s.grpcServer)}catch(s){c(s instanceof Error?s:new Error("Failed to fetch settings"))}finally{g(!1)}}async function k(){try{j(!0),c(null),l(!1),await H({serverHost:i,grpcPort:parseInt(d,10)||50051}),l(!0),setTimeout(()=>l(!1),3e3),await o()}catch(s){c(s instanceof Error?s:new Error("Failed to save settings"))}finally{j(!1)}}return P?e.jsx("div",{className:"container mx-auto p-4",children:e.jsx("div",{className:"text-center",children:"Loading settings..."})}):e.jsxs("div",{className:"container mx-auto p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-medium mb-2",children:"Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure server settings"})]}),f&&e.jsx(a,{children:e.jsx(n,{className:"py-4 text-destructive",children:f.message})}),b&&e.jsx(a,{children:e.jsx(n,{className:"py-4 text-green-600 dark:text-green-400",children:"Settings saved successfully!"})}),e.jsxs(a,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-sm",children:"Appearance"})}),e.jsx(n,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-sm font-medium",children:"Dark Mode"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Toggle between light and dark theme"})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:C,children:y==="dark"?"Light":"Dark"})]})})]}),e.jsxs(a,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-sm",children:"Server Configuration"})}),e.jsxs(n,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure the server hostname or IP address. This is used for enrollment codes so that Home Assistant add-ons know where to connect."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"server-host",children:"Server Host"}),e.jsx(S,{id:"server-host",value:i,onChange:s=>v(s.target.value),placeholder:"e.g., 192.168.1.100 or myserver.local"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The public hostname or IP address of this server (without port or protocol)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"grpc-port",children:"gRPC Port"}),e.jsx(S,{id:"grpc-port",type:"number",value:d,onChange:s=>N(s.target.value),placeholder:"50051"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The port the gRPC server listens on (default: 50051)"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{onClick:k,disabled:p,children:p?"Saving...":"Save"})})]})]}),e.jsxs(a,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-sm",children:"gRPC Server Status"})}),e.jsxs(n,{className:"space-y-4",children:[r?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsx(T,{variant:r.running?"default":"destructive",children:r.running?"Running":"Stopped"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Connected Addons:"}),e.jsx("span",{className:"text-sm",children:r.connectedAddons})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Sessions:"}),e.jsx("span",{className:"text-sm",children:r.activeSessions})]}),i&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"gRPC Address:"}),e.jsxs("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:[i,":",d]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unable to fetch gRPC server status"}),e.jsx(m,{variant:"outline",size:"sm",onClick:o,children:"Refresh Status"})]})]})]})}export{B as component};
